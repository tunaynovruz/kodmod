---
slug: /consistent-hashing
tags: [consistent-hashing, distributed-systems]
sidebar_position: 10
---

# Consistent Hashing
Consistent Hashing paylanmÄ±ÅŸ sistemlÉ™rdÉ™ serverlÉ™rin É™lavÉ™ edilmÉ™si vÉ™ ya Ã§Ä±xarÄ±lmasÄ± zamanÄ± minimal data yenidÉ™n paylaÅŸdÄ±rma tÉ™min edÉ™n hash Ã¼suludur. Bu Ã¼sul hÉ™lqÉ™vi struktur istifadÉ™ edÉ™rÉ™k scale etmÉ™ problemlÉ™rini hÉ™ll edir.

### NÉ™ Ã¼Ã§Ã¼n lazÄ±mdÄ±r?
- **Minimal data kÃ¶Ã§Ã¼rmÉ™:** Server dÉ™yiÅŸikliklÉ™rindÉ™ az mÉ™lumat yenidÉ™n paylaÅŸdÄ±rÄ±lÄ±r
- **Scale etmÉ™ asanlÄ±ÄŸÄ±:** Yeni serverlÉ™r É™lavÉ™ etmÉ™k vÉ™ Ã§Ä±xarmaq sadÉ™dir
- **Fault tolerance:** Server nasazlÄ±ÄŸÄ±nda sistem iÅŸlÉ™mÉ™yÉ™ davam edir
- **Load balancing:** MÉ™lumatlarÄ± serverlÉ™r arasÄ±nda bÉ™rabÉ™r paylaÅŸdÄ±rÄ±r
- **Cache efficiency:** Cache miss-lÉ™rini minimuma endirir

### ÆnÉ™nÉ™vi Hash ProblemlÉ™ri
- **Tam redistribution:** Server sayÄ± dÉ™yiÅŸÉ™ndÉ™ bÃ¼tÃ¼n data kÃ¶Ã§Ã¼rÃ¼lmÉ™li olur
- **Cache miss storm:** BÃ¼tÃ¼n cache-lÉ™r invalid olur vÉ™ DB-yÉ™ yÃ¼k dÃ¼ÅŸÃ¼r
- **Scale Ã§É™tinliyi:** Yeni server É™lavÉ™ etmÉ™k bÃ¶yÃ¼k É™mÉ™liyyat tÉ™lÉ™b edir
- **Hotspot yaranmasÄ±:** BÉ™zi serverlÉ™rÉ™ Ã§ox yÃ¼k dÃ¼ÅŸÃ¼r

### Hash Ring Ä°ÅŸ Prinsipi
- **HÉ™lqÉ™vi struktur:** 0-dan 2Â³Â²-1-É™ qÉ™dÉ™r hÉ™lqÉ™vi fÉ™za
- **Server yerlÉ™ÅŸdirmÉ™:** HÉ™r server hÉ™lqÉ™dÉ™ tÉ™sadÃ¼fi nÃ¶qtÉ™dÉ™ yerlÉ™ÅŸir
- **Key mapping:** AÃ§ar hÉ™lqÉ™dÉ™ yerlÉ™ÅŸir vÉ™ saat É™qrÉ™bi istiqamÉ™tindÉ™ ilk serverÉ™ yÃ¶nÉ™lir
- **Clockwise axtarÄ±ÅŸ:** Key-dÉ™n baÅŸlayaraq saat É™qrÉ™bi istiqamÉ™tindÉ™ ilk server tapÄ±lÄ±r

### Virtual Nodes (VNodes)
- **Ã‡ox nÃ¶qtÉ™:** HÉ™r server hÉ™lqÉ™dÉ™ Ã§oxlu nÃ¶qtÉ™dÉ™ tÉ™msil olunur
- **BÉ™rabÉ™r paylaÅŸma:** Load daha bÉ™rabÉ™r paylaÅŸdÄ±rÄ±lÄ±r
- **Elastiklik:** Server É™lavÉ™/Ã§Ä±xarÄ±landa yÃ¼k bÉ™rabÉ™r paylanÄ±r
- **Hash variations:** DB1-vn1, DB1-vn2 kimi mÃ¼xtÉ™lif hash-lÉ™r

### HÉ™yata KeÃ§irmÉ™ AddÄ±mlarÄ±
- **Hash funksiya seÃ§mÉ™k:** MD5, SHA-1, SHA-256
- **Hash ring tÉ™yin etmÉ™k:** 2Â³Â² Ã¶lÃ§Ã¼sÃ¼ndÉ™ hÉ™lqÉ™
- **ServerlÉ™ri yerlÉ™ÅŸdirmÉ™k:** Hash(server_id) ilÉ™ mÃ¶vqe tÉ™yin etmÉ™k
- **Key mapping:** Hash(key) ilÉ™ server tapmaq
- **Server É™lavÉ™/Ã§Ä±xarma:** YalnÄ±z tÉ™sir edÉ™n key-lÉ™ri yenidÉ™n mapping

### Real World Ä°stifadÉ™
- **Apache Cassandra:** Data distribution Ã¼Ã§Ã¼n
- **Amazon DynamoDB:** Sharding Ã¼Ã§Ã¼n
- **Redis Cluster:** Key partitioning Ã¼Ã§Ã¼n
- **CDN-lÉ™r:** Content distribution Ã¼Ã§Ã¼n
- **Load Balancers:** Session persistence Ã¼Ã§Ã¼n

### ÃœstÃ¼nlÃ¼klÉ™r vÉ™ MÉ™nfi CÉ™hÉ™tlÉ™ri
**ÃœstÃ¼nlÃ¼klÉ™r:**
- Minimal key remapping
- Horizontal scalability
- Fault tolerance
- Load balancing

**MÉ™nfi cÉ™hÉ™tlÉ™r:**
- Key ordering itir
- Hash function mÃ¼rÉ™kkÉ™bliyi
- Virtual node konfiqurasiya
- Memory overhead

### Æsas ProblemlÉ™r
- **Hash function quality:** Pis hash hotspot yaradÄ±r â†’ YaxÅŸÄ± hash (SHA-256) istifadÉ™ et
- **Virtual node sayÄ±:** Az vnode load imbalance yaradÄ±r â†’ HÉ™r server Ã¼Ã§Ã¼n 100-200 vnode
- **Server failure:** MÉ™lumat itkisi â†’ Replication factor artÄ±r (RF=3)
- **Network partitions:** Ring inconsistency â†’ Gossip protocol iÅŸlÉ™t  
- **Key hotspots:** BÉ™zi key-lÉ™r Ã§ox istifadÉ™ olunur â†’ Application-level caching É™lavÉ™ et

```mermaid
graph TB
    subgraph "Hash Ring (0 to 2Â³Â²-1)"
        Ring[ğŸ”„ Hash Ring]
        Node1[ğŸ–¥ï¸ Server A<br/>Hash: 100]
        Node2[ğŸ–¥ï¸ Server B<br/>Hash: 300] 
        Node3[ğŸ–¥ï¸ Server C<br/>Hash: 500]
        Node4[ğŸ–¥ï¸ Server D<br/>Hash: 700]
        
        Key1[ğŸ”‘ Key1: 150<br/>â†’ Server B]
        Key2[ğŸ”‘ Key2: 400<br/>â†’ Server C]
        Key3[ğŸ”‘ Key3: 600<br/>â†’ Server D]
        Key4[ğŸ”‘ Key4: 50<br/>â†’ Server A]
    end
    
    subgraph "Virtual Nodes"
        VN1[ğŸ–¥ï¸ Server A<br/>VN1: 80, VN2: 250<br/>VN3: 450, VN4: 650]
        VN2[ğŸ–¥ï¸ Server B<br/>VN1: 120, VN2: 320<br/>VN3: 520, VN4: 720]
    end
    
    subgraph "Server Operations"
        Add[â• Server É™lavÉ™ et<br/>YalnÄ±z tÉ™sir edÉ™n key-lÉ™r kÃ¶Ã§Ã¼rÃ¼lÃ¼r]
        Remove[â– Server Ã§Ä±xart<br/>Key-lÉ™r nÃ¶vbÉ™ti serverÉ™ keÃ§ir]
        Failure[âŒ Server nasazlÄ±ÄŸÄ±<br/>Avtomatik failover]
    end
    
    subgraph "ÆnÉ™nÉ™vi Hash vs Consistent Hash"
        Traditional[ğŸ“Š Modulo Hash<br/>hash #0040;key##0040; % N<br/> Tam redistribution]
        Consistent[ğŸ”„ Consistent Hash<br/>HÉ™lqÉ™vi mapping<br/>âœ… Minimal kÃ¶Ã§Ã¼rmÉ™]
    end
    
    subgraph "Real-World Systems"
        Cassandra[ğŸ—‚ï¸ Cassandra<br/>Data partitioning]
        DynamoDB[ğŸ—„ï¸ DynamoDB<br/>Sharding]
        Redis[ğŸ”´ Redis Cluster<br/>Key distribution]
        CDN[ğŸŒ CDN<br/>Content placement]
    end
    
    Ring --> Node1
    Ring --> Node2
    Ring --> Node3
    Ring --> Node4
    
    Node1 -.->|Clockwise| Node2
    Node2 -.->|Clockwise| Node3
    Node3 -.->|Clockwise| Node4
    Node4 -.->|Clockwise| Node1
    
    style Ring fill:#e1f5fe
    style Node1 fill:#e8f5e8
    style Node2 fill:#e8f5e8
    style Node3 fill:#e8f5e8
    style Node4 fill:#e8f5e8
    style Traditional fill:#ffebee
    style Consistent fill:#e8f5e8
    style VN1 fill:#fff3e0
    style VN2 fill:#fff3e0
```




